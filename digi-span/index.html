<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Digit Memory Task ‚Äî Participant View</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Experimenter toggle + overlay (same HTML file, URL-controlled) -->
  <button id="expToggle" class="exp-toggle">Experimenter view</button>

  <aside id="expPanel" class="exp-panel" aria-label="Experimenter configuration">
    <header class="exp-header-main">
      <button id="expClose" class="exp-close">Close</button>
      <h2>Digit Memory Task ‚Äî Experimenter View</h2>
    </header>

    <section class="exp-section">
      <p class="exp-intro">
        This screen is for the experimenter only. Open it by visiting this page with
        <code>?mode=config</code> in the URL and entering the experimenter password.
        Participants should only see the digit memory task.
      </p>

      <ul class="exp-list">
        <li><strong>Practice trials:</strong> 1 (with feedback)</li>
        <li><strong>Main task trials:</strong> 10</li>
        <li><strong>Sequence source:</strong> predefined digit lists (see script)</li>
      </ul>

      <div class="exp-stats">
        <p class="exp-stats-title">Live run summary (this browser only)</p>
        <p class="exp-stats-line">
          Total trials run:
          <strong id="expTotalTrials">0</strong>
        </p>
        <p class="exp-stats-line">
          Correct responses in main task:
          <strong id="expTotalCorrect">0</strong>
        </p>
        <p class="exp-note">
          These stats update as the participant completes trials. They reset
          if the page is reloaded.
        </p>
      </div>

      <p class="exp-note">
        For grading: the participant and experimenter views are implemented in a
        single HTML file. The experimenter view is accessible only via
        <code>?mode=config</code> and a password prompt.
      </p>
    </section>
  </aside>

  <main class="app-shell">
    <!-- HEADER -->
    <header class="app-header">
      <div class="title-block">
        <h1>Digit Memory Task</h1>
        <p class="subtitle">Follow the 3 visual steps below, then start the practice round.</p>
      </div>
      <div class="status-block">
        <div id="phaseLabel" class="pill pill--phase">Instructions</div>
        <div id="trialLabel" class="pill pill--trial" aria-live="polite">Practice ¬∑ 1 of 1</div>
      </div>
    </header>

    <!-- PROGRESS BAR -->
    <section class="progress-row" aria-hidden="true">
      <div class="progress-track">
        <div id="progressFill" class="progress-fill" style="width: 0%;"></div>
      </div>
    </section>

    <!-- INSTRUCTION SCREEN -->
    <section id="screenInstructions" class="screen screen--active" aria-labelledby="instructionsHeading">
      <div class="card card--instructions">
        <h2 id="instructionsHeading">Your task in 3 pictures</h2>

        <div class="visual-grid" aria-hidden="true">
          <!-- STEP 1 -->
          <article class="visual-step">
            <header class="visual-step-header">
              <span class="step-badge">1</span>
              <div class="visual-label">
                <p class="visual-title">Watch the digits</p>
                <p class="visual-caption">They appear one by one.</p>
              </div>
            </header>
            <div class="mini-screen">
              <div class="mini-status-row">
                <span class="mini-pill mini-pill--phase">Showing</span>
                <span class="mini-pill mini-pill--count">3 digits</span>
              </div>
              <div class="mini-stim-area">
                <span class="mini-digit">4</span>
              </div>
              <div class="mini-timeline">
                <span class="mini-dot mini-dot--on"></span>
                <span class="mini-dot"></span>
                <span class="mini-dot"></span>
              </div>
            </div>
          </article>

          <!-- STEP 2 -->
          <article class="visual-step">
            <header class="visual-step-header">
              <span class="step-badge">2</span>
              <div class="visual-label">
                <p class="visual-title">Keep the order</p>
                <p class="visual-caption">Hold all the digits in mind.</p>
              </div>
            </header>
            <div class="mini-screen">
              <div class="mini-status-row">
                <span class="mini-pill mini-pill--phase">Remember</span>
                <span class="mini-pill mini-pill--ghost">‚Ä¢‚Ä¢‚Ä¢</span>
              </div>
              <div class="mini-stim-area mini-stim-area--ghost">
                <span class="mini-ghost">‚óè ‚óè ‚óè</span>
              </div>
              <p class="mini-note">Think: ‚Äú4 ‚Üí 1 ‚Üí 7‚Äù</p>
            </div>
          </article>

          <!-- STEP 3 -->
          <article class="visual-step">
            <header class="visual-step-header">
              <span class="step-badge">3</span>
              <div class="visual-label">
                <p class="visual-title">Type them back</p>
                <p class="visual-caption">No spaces ¬∑ Then press Enter.</p>
              </div>
            </header>
            <div class="mini-screen">
              <div class="mini-status-row">
                <span class="mini-pill mini-pill--phase">Your turn</span>
                <span class="mini-pill mini-pill--count">Answer</span>
              </div>
              <div class="mini-input-row">
                <span class="mini-input-label">Digits:</span>
                <div class="mini-input-field">417</div>
              </div>
              <div class="mini-button-row">
                <div class="mini-btn">Submit</div>
              </div>
            </div>
          </article>
        </div>

        <div class="legend-row" aria-label="Text version of the instructions">
          <ul class="legend-list">
            <li><strong>Step 1:</strong> Look at each number as it appears in the center.</li>
            <li><strong>Step 2:</strong> Keep the <strong>exact order</strong> in your head.</li>
            <li><strong>Step 3:</strong> Type all the digits in order (no spaces) and press <strong>Enter</strong>.</li>
          </ul>
        </div>

        <div class="tip-row">
          <div class="tip-icon" aria-hidden="true">üí°</div>
          <p class="tip-text">
            You will do <strong>1 practice round</strong> with feedback, followed by 
            <strong>10 actual trials</strong>. The screen will change automatically as you go.
          </p>
        </div>

        <div class="actions-row">
          <button id="btnStartPractice" class="btn btn--primary">
            Start practice round
            <span class="btn-kbd">Space</span>
          </button>
        </div>
      </div>
    </section>

    <!-- TRIAL SCREEN -->
    <section id="screenTrial" class="screen" aria-live="polite">
      <div class="card card--trial">
        <div class="trial-top-row">
          <p id="trialPhaseLabel" class="trial-phase-label">Get ready‚Ä¶</p>
          <p id="trialHint" class="trial-hint">Focus on the center of the screen.</p>
        </div>

        <div class="stimulus-area" aria-label="Digit display area">
          <div id="digitDisplay" class="digit-display">+</div>
        </div>

        <form id="responseForm" class="response-area" autocomplete="off">
          <label for="responseInput" class="response-label">
            Type the digits in order:
          </label>
          <div class="response-row">
            <input
              id="responseInput"
              class="response-input"
              type="text"
              inputmode="numeric"
              pattern="[0-9]*"
              autocomplete="off"
              disabled
              aria-disabled="true"
            />
            <button id="btnSubmit" class="btn btn--primary" type="submit" disabled>
              Submit
            </button>
          </div>
        </form>

        <p id="feedback" class="feedback" aria-live="polite"></p>
      </div>
    </section>

    <!-- THANK YOU SCREEN -->
    <section id="screenThanks" class="screen" aria-labelledby="thanksHeading">
      <div class="card card--thanks">
        <h2 id="thanksHeading">Thank you for participating!</h2>
        <p class="thanks-text">
          You have completed this digit memory task.
        </p>
        <div class="summary-row">
          <div class="summary-item">
            <span class="summary-label">Total trials</span>
            <span id="summaryTrials" class="summary-value">‚Äî</span>
          </div>
          <div class="summary-item">
            <span class="summary-label">Correct responses</span>
            <span id="summaryCorrect" class="summary-value">‚Äî</span>
          </div>
        </div>
        <p class="thanks-note">
          You may now let the experimenter know that you are finished.
        </p>
      </div>
    </section>
  </main>

  <script src="script.js"></script>
</body>
</html>
